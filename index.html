<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dynamic Student Marks Table Generator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .section { margin-bottom: 28px; }
    table { border-collapse: collapse; width: 95%; margin-top: 16px; }
    th, td { border: 1px solid #aaa; padding: 8px; text-align: center; }
    th { background: #f0f0f0; }
    input[type="number"], input[type="text"] { width: 90%; padding: 2px; }
    .btn { padding: 6px 12px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Dynamic Student Marks Table Generator</h1>

  <div class="section" id="setupSection">
    <form id="setupForm" onsubmit="event.preventDefault(); showSubjectsForm();">
      <label>How many subjects?
        <input type="number" id="subjectCount" min="1" max="20" required>
      </label>
      <br><br>
      <label>How many students?
        <input type="number" id="studentCount" min="1" max="100" required>
      </label>
      <br><br>
      <button type="submit" class="btn">Next</button>
    </form>
  </div>

  <div class="section" id="subjectsSection" style="display:none;">
    <form id="subjectsForm" onsubmit="event.preventDefault(); showNamesPrompt();">
      <div id="subjectsInputs"></div>
      <br>
      <button type="submit" class="btn">Next</button>
    </form>
  </div>

  <div class="section" id="namesPromptSection" style="display:none;">
    <span>Do you want to input the names of the students as well?</span>
    <button class="btn" onclick="generateTable(true)">Yes</button>
    <button class="btn" onclick="generateTable(false)">No</button>
  </div>

  <div class="section" id="marksTableSection" style="display:none;">
    <form id="marksForm" onsubmit="event.preventDefault(); alert('Marks saved!');">
      <div id="marksTableContainer"></div>
      <br>
      <button type="submit" class="btn">Save Marks</button>
    </form>
  </div>

  <script>
    let subjectCount = 0, studentCount = 0, subjects = [], subjectMaxMarks = [], askNames = false;

    function showSubjectsForm() {
      subjectCount = parseInt(document.getElementById('subjectCount').value, 10);
      studentCount = parseInt(document.getElementById('studentCount').value, 10);
      if (!subjectCount || !studentCount) return;
      let html = '';
      for (let i = 1; i <= subjectCount; i++) {
        html += `<label>Subject ${i} Name: <input type="text" required id="subName${i}" placeholder="Subject ${i}"></label>
                 <label> Max Marks: <input type="number" min="1" required id="subMarks${i}"></label><br><br>`;
      }
      document.getElementById('subjectsInputs').innerHTML = html;
      document.getElementById('setupSection').style.display = 'none';
      document.getElementById('subjectsSection').style.display = '';
    }

    function showNamesPrompt() {
      subjects = [];
      subjectMaxMarks = [];
      for (let i = 1; i <= subjectCount; i++) {
        subjects.push(document.getElementById(`subName${i}`).value.trim() || `Subject ${i}`);
        subjectMaxMarks.push(parseInt(document.getElementById(`subMarks${i}`).value, 10) || 0);
      }
      document.getElementById('subjectsSection').style.display = 'none';
      document.getElementById('namesPromptSection').style.display = '';
    }

    function generateTable(withNames) {
      askNames = withNames;
      document.getElementById('namesPromptSection').style.display = 'none';
      let table = '<table><thead><tr><th>Roll No.</th>';
      if (askNames) table += '<th>Name</th>';
      for (let i = 0; i < subjectCount; i++) {
        table += `<th>${subjects[i]}<br>(Max: ${subjectMaxMarks[i]})</th>`;
      }
      table += '</tr></thead><tbody>';
      for (let r = 1; r <= studentCount; r++) {
        table += `<tr><td>${r}</td>`;
        if (askNames) table += `<td><input type="text" placeholder="Student ${r}" name="studentName${r}"></td>`;
        for (let s = 0; s < subjectCount; s++) {
          table += `<td><input type="number" min="0" max="${subjectMaxMarks[s]}" name="marks_${r}_${s}"></td>`;
        }
        table += '</tr>';
      }
      table += '</tbody></table>';
      document.getElementById('marksTableContainer').innerHTML = table;
      document.getElementById('marksTableSection').style.display = '';
    }
  </script>
</body>
</html>
